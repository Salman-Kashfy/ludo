enum TableSessionStatus {
    booked
    active
    completed
    cancelled
}

type TableSession {
    uuid: ID!
    customerId: Int!
    tableId: Int!
    startTime: String
    endTime: String
    totalAmount: Float
    status: TableSessionStatus!
    createdAt: String!
    updatedAt: String!
    
    # Relations
    customer: Customer!
    table: Table!
}

extend type Query {
    tableSession(id: ID!): TableSessionPayload @requireAuth @requirePermissions(permissions: ["table_session:view"])
    tableSessions(paging: PaginatorInput, params: TableSessionFilter): TableSessionsPayload! @requireAuth @requirePermissions(permissions: ["table_session:view"])
    activeTableSessions: TableSessionsPayload! @requireAuth @requirePermissions(permissions: ["table_session:view"])
}

extend type Mutation {
    startTableSession(input: StartTableSessionInput!): SaveTableSessionPayload @requireAuth @requirePermissions(permissions: ["table_session:create"])
    endTableSession(input: EndTableSessionInput!): SaveTableSessionPayload @requireAuth @requirePermissions(permissions: ["table_session:update"])
    cancelTableSession(id: ID!): SaveTableSessionPayload @requireAuth @requirePermissions(permissions: ["table_session:update"])
}

input TableSessionFilter {
    searchText: String
    customerId: Int
    tableId: Int
    status: TableSessionStatus
    dateFrom: String
    dateTo: String
}

type TableSessionPayload {
    data: TableSession
    errors: [GlobalError]
    status: Boolean
    errorMessage: String
}

type TableSessionsPayload {
    list: [TableSession]
    paging: PaginatorOutputUpdated
}

input StartTableSessionInput {
    customerId: Int!
    tableId: Int!
}

input EndTableSessionInput {
    id: ID!
    endTime: String
}

type SaveTableSessionPayload {
    data: TableSession
    errors: GlobalError
    status: Boolean
    errorMessage: String
}
