enum TableSessionStatus {
    booked
    active
    completed
    cancelled
}

type TableSession {
    uuid: ID!
    customerId: Int!
    tableId: Int!
    startTime: Datetime
    endTime: Datetime
    duration: Float
    unit: String
    totalAmount: Float
    status: TableSessionStatus!
    
    # Relations
    customer: Customer!
    table: Table!
}

extend type Query {
    tableSession(id: ID!): TableSessionPayload @requireAuth @requirePermissions(permissions: ["table_session:view"])
    tableSessions(paging: PaginatorInput, params: TableSessionFilter): TableSessionsPayload! @requireAuth @requirePermissions(permissions: ["table_session:view"])
    activeTableSessions: TableSessionsPayload! @requireAuth @requirePermissions(permissions: ["table_session:view"])
}

extend type Mutation {
    bookTableSession(input: BookTableSessionInput!): SaveTableSessionPayload @requireAuth @requirePermissions(permissions: ["table_session:upsert"])
    startTableSession(input: StartTableSessionInput!): SaveTableSessionPayload @requireAuth @requirePermissions(permissions: ["table_session:upsert"])
    rechargeTableSession(input: RechargeTableSessionInput!): SaveTableSessionPayload @requireAuth @requirePermissions(permissions: ["table_session:upsert"])
    markCompleted(input: MarkCompletedInput!): SaveTableSessionPayload @requireAuth @requirePermissions(permissions: ["table_session:upsert"])
    stopTableSession(input: StopTableSessionInput!): SaveTableSessionPayload @requireAuth @requirePermissions(permissions: ["table_session:upsert"])
}

input TableSessionFilter {
    searchText: String
    customerId: Int
    tableId: Int
    status: TableSessionStatus
    dateFrom: String
    dateTo: String
}

type TableSessionPayload {
    data: TableSession
    errors: [GlobalError]
    status: Boolean
    errorMessage: String
}

type TableSessionsPayload {
    list: [TableSession]
    paging: PaginatorOutputUpdated
}

input BookTableSessionInput {
    companyUuid: ID!
    customerUuid: ID!
    tableUuid: ID!
    categoryPriceUuid: ID!
    paymentMethod:PaymentMethodInput!
}

input StartTableSessionInput {
    companyUuid: ID!
    tableSessionUuid: ID!
}

input RechargeTableSessionInput {
    companyUuid: ID!
    tableSessionUuid: ID!
    categoryPriceUuid: ID!
    paymentMethod:PaymentMethodInput!
}

input MarkCompletedInput {
    tableSessionUuid: ID!
}

input StopTableSessionInput {
    tableSessionUuid: ID!
}

type SaveTableSessionPayload {
    data: TableSession
    errors: [GlobalError]
    status: Boolean
    errorMessage: String
}
