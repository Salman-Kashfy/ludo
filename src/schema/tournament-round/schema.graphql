type TournamentPlayers {
    uuid: ID!
    phone: String!
    isWinner: Boolean
}

type TournamentTable {
    uuid: ID!
    name: String!
    customers: TournamentPlayers
}

type TournamentRound {
    id: Int!
    uuid: ID!
    tournamentId: Int!
    round: Int!
    playerCount: Int!
    tableCount: Int!
    status: TournamentRoundStatus!
    createdAt: Datetime!
    updatedAt: Datetime!
    startedAt: Datetime
    completedAt: Datetime

    # Relations
    tournament: Tournament
    table: TournamentTable
}

type TournamentRoundAssignment {
    round: Int!
    tableId: Int!
    table: Table
    playerIds: [Int!]!
    entries: [TournamentRound!]!
}

#------------------------
# Queries
#------------------------
extend type Query {
    tournamentRounds(params: TournamentRoundFilter!): TournamentRoundsPayload! @requireAuth @requirePermissions(permissions: ["tournament:view"])
}

#------------------------
# Mutations
#------------------------
extend type Mutation {
    startTournament(input: StartTournamentInput!): TournamentRoundTransitionPayload! @requireAuth @requirePermissions(permissions: ["tournament:create"])
    completeTournamentRound(input: CompleteTournamentRoundInput!): CompleteTournamentRoundPayload! @requireAuth @requirePermissions(permissions: ["tournament:create"])
    startNextTournamentRound(input: StartNextTournamentRoundInput!): TournamentRoundTransitionPayload! @requireAuth @requirePermissions(permissions: ["tournament:create"])
}

input TournamentRoundFilter {
    tournamentUuid: ID!
    round: Int!
}

input StartTournamentInput {
    tournamentUuid: ID!
    randomize: Boolean
}

input CompleteTournamentRoundInput {
    tournamentUuid: ID!
    round: Int
    winnerCustomerIds: [Int!]!
}

input StartNextTournamentRoundInput {
    tournamentUuid: ID!
    randomize: Boolean
}

type TournamentRoundPayload {
    status: Boolean
    data: TournamentRound
    errors: [GlobalError]
    errorMessage: String
}

type TournamentRoundsPayload {
    list: [TournamentRound]
}

type TournamentRoundTransitionPayload {
    data: Tournament
    errors: [GlobalError]
    status: Boolean
    errorMessage: String
}

type CompleteTournamentRoundPayload {
    status: Boolean
    tournament: Tournament
    winners: [TournamentRound]
    errors: [GlobalError]
    errorMessage: String
}

enum TournamentRoundStatus {
    UPCOMING
    ACTIVE
    COMPLETED
    CANCELLED
}